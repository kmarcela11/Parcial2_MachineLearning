
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Ejercicio 3: Modelos de Regresión &#8212; Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ejercicio3';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Ejercicio 2: Modelos de Clasificación" href="Ejercicio2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/uninorte.jpg" class="logo__image only-light" alt="Machine Learning - Home"/>
    <script>document.write(`<img src="_static/uninorte.jpg" class="logo__image only-dark" alt="Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial 2- Machine Learning
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ejercicio1.html"><strong>Ejercicio 1.1</strong></a></li>


<li class="toctree-l1"><a class="reference internal" href="informe.html"><strong>Ejercicio 1.2: Research</strong></a></li>



<li class="toctree-l1"><a class="reference internal" href="Ejercicio2.html"><strong>Ejercicio 2: Modelos de Clasificación</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Ejercicio 3: Modelos de Regresión</strong></a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kmarcela11/Parcial2_MachineLearning" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kmarcela11/Parcial2_MachineLearning/issues/new?title=Issue%20on%20page%20%2FEjercicio3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Ejercicio3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ejercicio 3: Modelos de Regresión</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Ejercicio 3: Modelos de Regresión</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-wind-speed"><strong>Modelo de regresión: Wind Speed</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos"><strong>Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diferencias-entre-la-base-de-datos-original-y-la-del-modelo"><strong>Diferencias entre la base de datos original y la del modelo</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>Modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-para-construir-los-pliegues"><strong>Función para construir los pliegues</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-individuales-por-horas-24-horas"><strong>Modelos individuales por horas (24 horas)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-1"><strong>Pronóstico de la hora 1</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-2"><strong>Pronóstico de la hora 2</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-3"><strong>Pronóstico de la hora 3</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-4"><strong>Pronóstico de la hora 4</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-5"><strong>Pronóstico de la hora 5</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-6"><strong>Pronóstico de la hora 6</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-7"><strong>Pronóstico de la hora 7</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-8"><strong>Pronóstico de la hora 8</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-9"><strong>Pronóstico de la hora 9</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-10"><strong>Pronóstico de la hora 10</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-11"><strong>Pronóstico de la hora 11</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-12"><strong>Pronóstico de la hora 12</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-13"><strong>Pronóstico de la hora 13</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-14"><strong>Pronóstico de la hora 14</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-15"><strong>Pronóstico de la hora 15</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-16"><strong>Pronóstico de la hora 16</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-17"><strong>Pronóstico de la hora 17</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-18"><strong>Pronóstico de la hora 18</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-19"><strong>Pronóstico de la hora 19</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-20"><strong>Pronóstico de la hora 20</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-21"><strong>Pronóstico de la hora 21</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-22"><strong>Pronóstico de la hora 22</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-23"><strong>Pronóstico de la hora 23</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-24"><strong>Pronóstico de la hora 24</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-general"><strong>Interpretación general</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-en-general"><strong>Modelos en general</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-k-nn"><strong>Modelos de regresión K-NN</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-lineal"><strong>Modelos de regresión lineal</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-ridge"><strong>Modelos de regresión Ridge</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-lasso"><strong>Modelos de regresión Lasso</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mejores-modelos"><strong>Mejores modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-hipotesis-para-los-residuos"><strong>Pruebas de hipótesis para los residuos</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hiperparametrizacion-optimizacion-bayesiana"><strong>Hiperparametrización: Optimización Bayesiana</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-final"><strong>Modelo final</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-con-los-mejores-hiperparametros"><strong>Modelo con los mejores hiperpárametros</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-del-modelo-final"><strong>Gráfica del modelo final</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ejercicio-3-modelos-de-regresion">
<h1><strong>Ejercicio 3: Modelos de Regresión</strong><a class="headerlink" href="#ejercicio-3-modelos-de-regresion" title="Link to this heading">#</a></h1>
<p><strong>Modelos de Regresión.</strong> Considere el conjunto de datos <strong>Wind Speed</strong>. Implemente la versión de regresión de cada uno de los modelos estudiados en clases, para predecir la velocidad del viento horaria (<strong>VENTO, VELOCIDADE HORARIA (m/s)</strong>) en el conjunto de datos suministrado. Construya una tabla de error con las métricas usuales de regresión: <strong>MAPE, RMSE, R2</strong> (ver <strong>Table 2</strong>). Además, agregue pruebas de independencia y normalidad para los residuos: <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Realice particiones de entrenamiento, validación y prueba, basándose en lo descrito en la <strong>Figura 2</strong>. Estas particiones deben seguir la tendencia de la velocidad del viento. Genere una figura que represente la velocidad del viento y su predicción. Utilice las métricas <strong>MAPE, RMSE, R2</strong> en la fase de validación para seleccionar la mejor predicción. Identifique cuál de las métricas es la más adecuada. Use también la optimización bayesiana para seleccionar los mejores hiperparámetros del modelo de regresión óptimo.</p>
<p>El pliegue de validación en cada partición debe estar siempre ubicado en el porcentaje final de cada partición, ya que el tiempo es fundamental en dichas predicciones. No tiene sentido predecir el pasado conocido con el futuro. Entre los períodos diarios <strong>T = 7, 14, 21, 28</strong>, indique cuál corresponde a la mejor ventana de predicción para el entrenamiento. Tenga en cuenta que <strong>TimeSeriesSplit</strong> no aplica en este problema, por lo que no debe utilizarla, dado que dichos pliegues no corresponden a los solicitados en este ejercicio. Defina una función para construir los pliegues para este ejercicio.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head"><p>MAPE</p></th>
<th class="head"><p>RMSE</p></th>
<th class="head"><p>R²</p></th>
<th class="head"><p>Ljung-Box p-value</p></th>
<th class="head"><p>Jarque-Bera p-value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>K-NN</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>Linear Regression</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>Ridge Regression</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>Lasso Regression</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Cuadro 2:</strong> Modelo de regresión para <strong>mean sale price</strong>.</p>
<section id="librerias-y-modulos-necesarios">
<h2><strong>Librerías y modulos necesarios</strong><a class="headerlink" href="#librerias-y-modulos-necesarios" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">gp_minimize</span>
<span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Categorical</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelo-de-regresion-wind-speed">
<h1><strong>Modelo de regresión: Wind Speed</strong><a class="headerlink" href="#modelo-de-regresion-wind-speed" title="Link to this heading">#</a></h1>
<section id="datos">
<h2><strong>Datos</strong><a class="headerlink" href="#datos" title="Link to this heading">#</a></h2>
<p>Después de haber realizado un análisis descriptivo de la base de datos original (detallado <a class="reference external" href="https://kmarcela11.github.io/Parcial2_MachineLearning/Ejercicio1.html#wind-speed">Wind Speed - Ejercicio 1</a>
), finalmente se ha obtenido una base de datos preparada para realizar el modelo, la cual ha sido almacenada en un archivo CSV.</p>
<section id="diferencias-entre-la-base-de-datos-original-y-la-del-modelo">
<h3><strong>Diferencias entre la base de datos original y la del modelo</strong><a class="headerlink" href="#diferencias-entre-la-base-de-datos-original-y-la-del-modelo" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La nueva base de datos presenta nombres de columnas más legibles y mejor organizados.</p></li>
<li><p>Se han eliminado variables poco significativas para el modelo, como:</p>
<ul>
<li><p>La variable de <strong>hora</strong>.</p></li>
</ul>
</li>
<li><p>Se han excluido variables altamente correlacionadas, tales como:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">hum_horaria</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pres_atmo</span></code></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">kamac</span><span class="se">\\</span><span class="s1">OneDrive</span><span class="se">\\</span><span class="s1">Desktop</span><span class="se">\\</span><span class="s1">MachineLearningUN</span><span class="se">\\</span><span class="s1">data_modelo.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dir_viento</th>
      <th>vel_viento</th>
      <th>hum_max</th>
      <th>hum_min</th>
      <th>temp_max</th>
      <th>temp_min</th>
      <th>precip_total</th>
      <th>rafaga_max</th>
      <th>pres_max</th>
      <th>pres_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>-0.615661</td>
      <td>5.6</td>
      <td>83.0</td>
      <td>78.0</td>
      <td>21.8</td>
      <td>21.1</td>
      <td>0.0</td>
      <td>12.3</td>
      <td>879.8</td>
      <td>879.1</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>-0.469472</td>
      <td>4.9</td>
      <td>84.0</td>
      <td>79.0</td>
      <td>21.7</td>
      <td>21.0</td>
      <td>0.0</td>
      <td>9.9</td>
      <td>879.2</td>
      <td>878.9</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>-0.484810</td>
      <td>4.5</td>
      <td>86.0</td>
      <td>82.0</td>
      <td>21.2</td>
      <td>20.6</td>
      <td>0.0</td>
      <td>8.9</td>
      <td>879.8</td>
      <td>879.2</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>-0.484810</td>
      <td>3.2</td>
      <td>88.0</td>
      <td>85.0</td>
      <td>20.6</td>
      <td>20.2</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>880.5</td>
      <td>879.6</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>-0.573576</td>
      <td>2.3</td>
      <td>95.0</td>
      <td>88.0</td>
      <td>20.2</td>
      <td>19.3</td>
      <td>0.6</td>
      <td>7.5</td>
      <td>881.1</td>
      <td>880.5</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 10 columns</p>
</div></div></div>
</div>
<p>Nótese que la base de datos actual cuenta con <strong>87693</strong> observaciones y <strong>10</strong> columnas</p>
<p>Ahora, se asignan las variables predictoras y la variable objetivo, que en nuestro caso es la velocidad del viento (<code class="docutils literal notranslate"><span class="pre">vel_viento</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vel_viento&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vel_viento&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MAPEP</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
    <span class="c1"># Evitar la división por cero, ignorando los valores donde y_true es 0</span>
    <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">])</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="n">mape</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modelos">
<h2><strong>Modelos</strong><a class="headerlink" href="#modelos" title="Link to this heading">#</a></h2>
<p>El objetivo de este trabajo es realizar pruebas con datos para 24 horas, aplicando 4 modelos de regresión a cada una de esas horas (<strong>KNN Regressor</strong>, <strong>Linear Regression</strong>, <strong>Ridge</strong> y <strong>Lasso</strong>), lo que resultará en un total de <strong>96 modelos</strong>. Estos modelos serán representados en <strong>24 tablas</strong>, una para cada hora, y adicionalmente se agruparán en <strong>4 tablas por modelo</strong>, es decir, una tabla para <strong>KNN</strong>, una para <strong>Ridge</strong>, una para <strong>Lasso</strong> y otra para <strong>Linear Regression</strong>. En cada tabla, se analizará cómo varía la construcción de los pliegues y cómo estos afectan el rendimiento de los modelos.</p>
<p>Para la validación de los modelos, se utilizarán las métricas <strong>RMSE</strong>, <strong>MAPE</strong> y <strong><span class="math notranslate nohighlight">\(R^2\)</span></strong>. El propósito es seleccionar, de cada una de las cuatro tablas por modelo de regresión, el modelo con el menor <strong>RMSE</strong>. Estos se agruparán en una tabla que contendrá los <strong>4 mejores modelos</strong> obtenidos. Finalmente, de esos cuatro, el mejor será aquel que presente el menor <strong>RMSE</strong>, que, a su vez, será equivalente al que tenga el mejor <strong><span class="math notranslate nohighlight">\(R^2\)</span></strong>.</p>
<p>Se utiliza <strong>RMSE</strong> como métrica principal porque, al calcular la <strong>raíz cuadrada del promedio de los errores al cuadrado</strong>, penaliza más los errores grandes, proporcionando una evaluación más precisa del rendimiento del modelo en comparación con otras métricas como el MAPE o el MSE. Además, el <strong>RMSE</strong> es equivalente con el <strong><span class="math notranslate nohighlight">\(R^2\)</span></strong>, dado que a menor <strong>RMSE</strong> mayor coeficiente de determinación (<strong><span class="math notranslate nohighlight">\(R^2\)</span></strong>)</p>
<p>A continuación, se define un diccionario que contiene los modelos junto con los hiperparámetros óptimos obtenidos tras la optimización bayesiana. Estos valores ajustados permitirán evaluar y comparar el rendimiento de cada modelo de manera eficiente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir los modelos</span>
<span class="n">modelos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Regresión K-NN&#39;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(),</span>
    <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">:</span> <span class="n">LinearRegression</span><span class="p">(),</span>
    <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(),</span>
    <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">:</span> <span class="n">Lasso</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora se crea un código que define la función <strong><code class="docutils literal notranslate"><span class="pre">entrenar_y_evaluar</span></code></strong>, la cual entrena y evalúa múltiples modelos de regresión utilizando conjuntos de datos de entrenamiento y prueba. A cada modelo se le aplica una serie de métricas para medir su rendimiento, como <strong>RMSE</strong> (Root Mean Squared Error), <strong>MAPE</strong> (Mean Absolute Percentage Error) y <strong><span class="math notranslate nohighlight">\(R^2\)</span></strong> (coeficiente de determinación). Estos modelos se evalúan para una hora específica y una ventana de predicción representada por <code class="docutils literal notranslate"><span class="pre">k</span></code>. Los resultados obtenidos, que incluyen el nombre del modelo, la hora de predicción, la ventana de predicción y las métricas calculadas, se almacenan en una lista llamada <strong><code class="docutils literal notranslate"><span class="pre">resultados</span></code></strong>. De esta forma, se recopilan y organizan los resultados de las pruebas realizadas para su análisis posterior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">entrenar_y_evaluar</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">hora</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">modelo</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
        <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">RMSE</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">MAPE</span> <span class="o">=</span> <span class="n">MAPEP</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">R2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">({</span> 
            <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="n">nombre</span><span class="p">,</span>
            <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
            <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span>
            <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">MAPE</span><span class="p">,</span>
            <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
            <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">R2</span>
        <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<section id="funcion-para-construir-los-pliegues">
<h3><strong>Función para construir los pliegues</strong><a class="headerlink" href="#funcion-para-construir-los-pliegues" title="Link to this heading">#</a></h3>
<p>En esta sección, se definen dos funciones importantes para generar los pliegues de entrenamiento y prueba en función de distintas ventanas de predicción (7, 14, 21 y 28 días).</p>
<ol class="arabic simple">
<li><p>La primera función, <strong><code class="docutils literal notranslate"><span class="pre">pliegues</span></code></strong>, recibe los parámetros <code class="docutils literal notranslate"><span class="pre">train_inicial</span></code>, <code class="docutils literal notranslate"><span class="pre">train_final</span></code> y <code class="docutils literal notranslate"><span class="pre">hora</span></code>, y se encarga de calcular los índices para seleccionar los subconjuntos de datos de entrenamiento (<code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>) y prueba (<code class="docutils literal notranslate"><span class="pre">X_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_test</span></code>) mediante filtrado booleano sobre los índices del DataFrame. Devuelve estos subconjuntos para ser utilizados posteriormente.</p></li>
<li><p>La segunda función, <strong><code class="docutils literal notranslate"><span class="pre">pliegues_modelo_hora</span></code></strong>, toma los datos <code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, los modelos a evaluar, y la hora específica. Recorre cada uno de los períodos definidos en la lista <code class="docutils literal notranslate"><span class="pre">periodos</span></code> (7, 14, 21 y 28 días), y para cada ventana de predicción, calcula los índices de entrenamiento y prueba. Llama a la función <strong><code class="docutils literal notranslate"><span class="pre">pliegues</span></code></strong> para obtener los subconjuntos correspondientes y, posteriormente, los pasa a la función <strong><code class="docutils literal notranslate"><span class="pre">entrenar_y_evaluar</span></code></strong>, que se encarga de entrenar y evaluar los modelos en cada ventana de predicción. Además, la función actualiza <code class="docutils literal notranslate"><span class="pre">train_inicial</span></code> para avanzar a la siguiente ventana dentro del ciclo, lo que permite que el modelo recorra el conjunto de datos completo.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pliegues</span><span class="p">(</span><span class="n">train_inicial</span><span class="p">,</span> <span class="n">train_final</span><span class="p">,</span> <span class="n">hora</span><span class="p">):</span>
<span class="c1"># Filtrado booleano para X_train y y_train</span>
    <span class="n">entrenamiento_indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">train_inicial</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">train_final</span><span class="p">)</span> <span class="c1"># Se seleccionan los datos de entrenamiento</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">entrenamiento_indices</span><span class="p">]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">entrenamiento_indices</span><span class="p">]</span> 

    <span class="c1"># Filtrado booleano para X_test y y_test</span>
    <span class="n">test_indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">train_final</span> <span class="o">+</span> <span class="n">hora</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">train_final</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">24</span><span class="p">))</span> <span class="c1"># Se seleccionan los datos de prueba</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periodos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>  <span class="c1"># Vector que almacena el valor de los períodos díarios a tener en cuenta (ventanas de predicción)</span>

<span class="k">def</span> <span class="nf">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">modelos</span><span class="p">,</span> <span class="n">hora</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">periodos</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre vector de periodos para que el proceso se realice para cada una de las ventanas de predicción (7, 14, 21, 28)</span>
        <span class="n">train_inicial</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Se inicializa el índice de inicio de la ventana de entrenamiento</span>
        
        <span class="k">while</span> <span class="p">(</span><span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Ciclo que se ejecuta mientras la ventana de entrenamiento no sobrepase el tamaño del dataset</span>
            
            <span class="n">train_final</span> <span class="o">=</span> <span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>  <span class="c1"># Se calcula el índice final de la ventana de entrenamiento</span>
            
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">train_inicial</span><span class="p">,</span> <span class="n">train_final</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>  <span class="c1"># Se obtienen los conjuntos de entrenamiento y prueba</span>
            
            <span class="n">entrenar_y_evaluar</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span><span class="n">k</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>
            <span class="n">train_inicial</span> <span class="o">=</span> <span class="n">train_final</span>  <span class="c1"># Se actualiza para avanzar a la siguiente ventana.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelos-individuales-por-horas-24-horas">
<h3><strong>Modelos individuales por horas (24 horas)</strong><a class="headerlink" href="#modelos-individuales-por-horas-24-horas" title="Link to this heading">#</a></h3>
<p>Ahora, veamos lo anteriormente mencionado: los modelos individuales para cada una de las 24 horas, donde se aplican los cuatro modelos (<strong>KNN</strong>, <strong>Ridge</strong>, <strong>Lasso</strong> y <strong>Linear Regression</strong>).</p>
<ul class="simple">
<li><p>Para realizar esto:  Se ejecuta la función <strong><code class="docutils literal notranslate"><span class="pre">pliegues_modelo_hora</span></code></strong> para cada una de las 24 horas y se almacenan los resultados en el DataFrame <strong><code class="docutils literal notranslate"><span class="pre">hora{i}</span></code></strong>, donde <strong>i = 1,…,24</strong>. Luego, este DataFrame se agrupa por <strong>modelo</strong>, <strong>ventana de predicción</strong> y <strong>hora</strong>, utilizando el método <strong><code class="docutils literal notranslate"><span class="pre">groupby</span></code></strong> para calcular el promedio de las métricas de rendimiento. Finalmente, se genera <strong><code class="docutils literal notranslate"><span class="pre">hora{i}_mean</span></code></strong>, que contiene los valores medios de las métricas para cada modelo y ventana de predicción, lo que facilita el análisis comparativo de los resultados y permite identificar el mejor modelo según las métricas calculadas para cada hora específica.</p></li>
<li><p>Para comprender esto: Los resultados se presentan en una tabla con <strong>6 columnas y 16 filas</strong>, donde cada conjunto de 4 filas corresponde a uno de los 4 modelos aplicados  (<strong>KNN</strong>, <strong>Ridge</strong>, <strong>Lasso</strong> y <strong>Linear Regression</strong>) en las diferentes ventanas de predicción (7, 14, 21 y 28 días). Las columnas incluyen el <strong>modelo</strong>, la <strong>ventana de predicción</strong>, la <strong>hora</strong>, y las métricas de rendimiento: <strong>MAPE</strong>, <strong>RMSE</strong> y <strong>R²</strong>. Es importante destacar que la columna de la hora no varía dentro de cada tabla, ya que cada tabla es específica para una hora en particular. Las métricas permiten observar el comportamiento de los modelos en función de las ventanas de predicción, facilitando la comparación entre ellos.</p></li>
</ul>
<p><strong>Nota:</strong> Dado la cantidad de tablas generadas, las interpretaciones se encuentran de manera general al final, cuando se terminan las tablas.</p>
<section id="pronostico-de-la-hora-1">
<h4><strong>Pronóstico de la hora 1</strong><a class="headerlink" href="#pronostico-de-la-hora-1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hora1</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">modelos</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
<span class="n">hora1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora1_min_rmse</span> <span class="o">=</span> <span class="n">hora1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora1</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">hora1_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>7</td>
      <td>14.197404</td>
      <td>0.442003</td>
      <td>0.739650</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>14</td>
      <td>14.121390</td>
      <td>0.487220</td>
      <td>0.743249</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>21</td>
      <td>22.808862</td>
      <td>0.438482</td>
      <td>0.588184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>28</td>
      <td>9.585378</td>
      <td>0.399166</td>
      <td>0.803793</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>7</td>
      <td>16.526000</td>
      <td>0.368618</td>
      <td>0.432809</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>14</td>
      <td>14.921524</td>
      <td>0.423962</td>
      <td>0.481896</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>21</td>
      <td>26.271589</td>
      <td>0.395329</td>
      <td>0.888162</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>28</td>
      <td>14.907412</td>
      <td>0.418688</td>
      <td>0.494708</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>7</td>
      <td>34.968712</td>
      <td>0.294249</td>
      <td>0.852346</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>14</td>
      <td>17.518588</td>
      <td>0.343691</td>
      <td>0.506927</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>21</td>
      <td>21.192928</td>
      <td>0.326620</td>
      <td>0.923659</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>28</td>
      <td>11.537774</td>
      <td>0.335730</td>
      <td>0.864333</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>7</td>
      <td>35.469133</td>
      <td>0.296205</td>
      <td>0.850377</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>14</td>
      <td>17.659365</td>
      <td>0.345091</td>
      <td>0.502901</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>21</td>
      <td>21.192070</td>
      <td>0.326646</td>
      <td>0.923647</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>28</td>
      <td>11.507826</td>
      <td>0.335695</td>
      <td>0.864361</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-2">
<h4><strong>Pronóstico de la hora 2</strong><a class="headerlink" href="#pronostico-de-la-hora-2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora2</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">modelos</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
<span class="n">hora2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora2_min_rmse</span> <span class="o">=</span> <span class="n">hora2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora1</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">hora2_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>2</td>
      <td>7</td>
      <td>15.437170</td>
      <td>0.457566</td>
      <td>0.730520</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>2</td>
      <td>14</td>
      <td>14.770741</td>
      <td>0.494014</td>
      <td>0.736038</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>2</td>
      <td>21</td>
      <td>24.201313</td>
      <td>0.514312</td>
      <td>0.445958</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>2</td>
      <td>28</td>
      <td>9.850530</td>
      <td>0.403753</td>
      <td>0.749500</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>2</td>
      <td>7</td>
      <td>16.685253</td>
      <td>0.374123</td>
      <td>0.421321</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>2</td>
      <td>14</td>
      <td>16.495490</td>
      <td>0.472811</td>
      <td>0.387068</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>2</td>
      <td>21</td>
      <td>25.515211</td>
      <td>0.389335</td>
      <td>0.889422</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>2</td>
      <td>28</td>
      <td>16.458948</td>
      <td>0.463941</td>
      <td>0.409849</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>2</td>
      <td>7</td>
      <td>35.154450</td>
      <td>0.311646</td>
      <td>0.842928</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>2</td>
      <td>14</td>
      <td>17.367080</td>
      <td>0.343398</td>
      <td>0.512465</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>2</td>
      <td>21</td>
      <td>20.647312</td>
      <td>0.322638</td>
      <td>0.924063</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>2</td>
      <td>28</td>
      <td>10.637060</td>
      <td>0.322033</td>
      <td>0.870627</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>2</td>
      <td>7</td>
      <td>35.714950</td>
      <td>0.314434</td>
      <td>0.840105</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>2</td>
      <td>14</td>
      <td>17.491551</td>
      <td>0.344757</td>
      <td>0.508600</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>2</td>
      <td>21</td>
      <td>20.646736</td>
      <td>0.322672</td>
      <td>0.924047</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>2</td>
      <td>28</td>
      <td>10.604223</td>
      <td>0.321857</td>
      <td>0.870768</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-3">
<h4><strong>Pronóstico de la hora 3</strong><a class="headerlink" href="#pronostico-de-la-hora-3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora3</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">hora3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora3_min_rmse</span> <span class="o">=</span> <span class="n">hora3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora3_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>3</td>
      <td>7</td>
      <td>16.989267</td>
      <td>0.444503</td>
      <td>0.782061</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>3</td>
      <td>14</td>
      <td>10.401227</td>
      <td>0.483425</td>
      <td>0.716291</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>3</td>
      <td>21</td>
      <td>19.526820</td>
      <td>0.413199</td>
      <td>0.854273</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>3</td>
      <td>28</td>
      <td>12.129570</td>
      <td>0.432762</td>
      <td>0.755629</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>3</td>
      <td>7</td>
      <td>15.502170</td>
      <td>0.318170</td>
      <td>0.913595</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>3</td>
      <td>14</td>
      <td>24.095939</td>
      <td>0.451624</td>
      <td>0.251506</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>3</td>
      <td>21</td>
      <td>9.658325</td>
      <td>0.311801</td>
      <td>0.917019</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>3</td>
      <td>28</td>
      <td>10.991575</td>
      <td>0.456726</td>
      <td>0.597868</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>3</td>
      <td>7</td>
      <td>34.193844</td>
      <td>0.310303</td>
      <td>0.835795</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>3</td>
      <td>14</td>
      <td>10.414414</td>
      <td>0.330499</td>
      <td>0.852527</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>3</td>
      <td>21</td>
      <td>10.557081</td>
      <td>0.287760</td>
      <td>0.929322</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>3</td>
      <td>28</td>
      <td>10.774141</td>
      <td>0.323534</td>
      <td>0.858678</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>3</td>
      <td>7</td>
      <td>34.335095</td>
      <td>0.312458</td>
      <td>0.833507</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>3</td>
      <td>14</td>
      <td>10.394874</td>
      <td>0.331241</td>
      <td>0.851864</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>3</td>
      <td>21</td>
      <td>10.547096</td>
      <td>0.287738</td>
      <td>0.929333</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>3</td>
      <td>28</td>
      <td>10.731652</td>
      <td>0.323306</td>
      <td>0.858876</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-4">
<h4><strong>Pronóstico de la hora 4</strong><a class="headerlink" href="#pronostico-de-la-hora-4" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora4</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">hora4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora4_min_rmse</span> <span class="o">=</span> <span class="n">hora4</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora4</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora4_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>4</td>
      <td>7</td>
      <td>13.595712</td>
      <td>0.432493</td>
      <td>0.745294</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>4</td>
      <td>14</td>
      <td>10.448847</td>
      <td>0.481196</td>
      <td>0.724071</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>4</td>
      <td>21</td>
      <td>18.262616</td>
      <td>0.402906</td>
      <td>0.854985</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>4</td>
      <td>28</td>
      <td>15.046237</td>
      <td>0.434166</td>
      <td>0.805614</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>4</td>
      <td>7</td>
      <td>14.936429</td>
      <td>0.319067</td>
      <td>0.909057</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>4</td>
      <td>14</td>
      <td>19.711060</td>
      <td>0.430070</td>
      <td>0.694667</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>4</td>
      <td>21</td>
      <td>9.624911</td>
      <td>0.317652</td>
      <td>0.909862</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>4</td>
      <td>28</td>
      <td>24.431823</td>
      <td>0.456057</td>
      <td>0.518794</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>4</td>
      <td>7</td>
      <td>13.549728</td>
      <td>0.327209</td>
      <td>0.880260</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>4</td>
      <td>14</td>
      <td>10.423193</td>
      <td>0.330925</td>
      <td>0.845664</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>4</td>
      <td>21</td>
      <td>10.004757</td>
      <td>0.285625</td>
      <td>0.927122</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>4</td>
      <td>28</td>
      <td>10.765978</td>
      <td>0.323538</td>
      <td>0.852478</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>4</td>
      <td>7</td>
      <td>13.299895</td>
      <td>0.321472</td>
      <td>0.884422</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>4</td>
      <td>14</td>
      <td>10.408561</td>
      <td>0.331712</td>
      <td>0.844930</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>4</td>
      <td>21</td>
      <td>10.000924</td>
      <td>0.285639</td>
      <td>0.927115</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>4</td>
      <td>28</td>
      <td>10.720448</td>
      <td>0.323306</td>
      <td>0.852689</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-5">
<h4><strong>Pronóstico de la hora 5</strong><a class="headerlink" href="#pronostico-de-la-hora-5" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora5</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">hora5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora5_min_rmse</span> <span class="o">=</span> <span class="n">hora5</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora5</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hora5_min_rmse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>5</td>
      <td>7</td>
      <td>14.147091</td>
      <td>0.438387</td>
      <td>0.724461</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>5</td>
      <td>14</td>
      <td>21.678255</td>
      <td>0.468971</td>
      <td>0.485452</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>5</td>
      <td>21</td>
      <td>17.270552</td>
      <td>0.394483</td>
      <td>0.858206</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>5</td>
      <td>28</td>
      <td>14.149539</td>
      <td>0.402472</td>
      <td>0.848079</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>5</td>
      <td>7</td>
      <td>13.915467</td>
      <td>0.305140</td>
      <td>0.782162</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>5</td>
      <td>14</td>
      <td>21.404801</td>
      <td>0.415432</td>
      <td>0.596229</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>5</td>
      <td>21</td>
      <td>9.470311</td>
      <td>0.317293</td>
      <td>0.908268</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>5</td>
      <td>28</td>
      <td>23.349564</td>
      <td>0.426467</td>
      <td>0.574495</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>5</td>
      <td>7</td>
      <td>8.848311</td>
      <td>0.336981</td>
      <td>0.849481</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>5</td>
      <td>14</td>
      <td>10.239251</td>
      <td>0.330619</td>
      <td>0.825295</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>5</td>
      <td>21</td>
      <td>10.164552</td>
      <td>0.288461</td>
      <td>0.924181</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>5</td>
      <td>28</td>
      <td>10.396090</td>
      <td>0.322318</td>
      <td>0.833958</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>5</td>
      <td>7</td>
      <td>8.846539</td>
      <td>0.336004</td>
      <td>0.850351</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>5</td>
      <td>14</td>
      <td>10.226029</td>
      <td>0.331410</td>
      <td>0.824458</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>5</td>
      <td>21</td>
      <td>10.166551</td>
      <td>0.288539</td>
      <td>0.924140</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>5</td>
      <td>28</td>
      <td>10.352729</td>
      <td>0.322098</td>
      <td>0.834184</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-6">
<h4><strong>Pronóstico de la hora 6</strong><a class="headerlink" href="#pronostico-de-la-hora-6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora6</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">hora6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora6_min_rmse</span> <span class="o">=</span> <span class="n">hora6</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora6</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hora6_min_rmse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>6</td>
      <td>7</td>
      <td>14.334712</td>
      <td>0.441324</td>
      <td>0.718410</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>6</td>
      <td>14</td>
      <td>22.126171</td>
      <td>0.474043</td>
      <td>0.478729</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>6</td>
      <td>21</td>
      <td>15.673330</td>
      <td>0.385962</td>
      <td>0.857199</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>6</td>
      <td>28</td>
      <td>14.360695</td>
      <td>0.404516</td>
      <td>0.840520</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>6</td>
      <td>7</td>
      <td>12.610870</td>
      <td>0.300416</td>
      <td>0.913486</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>6</td>
      <td>14</td>
      <td>21.678055</td>
      <td>0.419248</td>
      <td>0.592273</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>6</td>
      <td>21</td>
      <td>8.094454</td>
      <td>0.309388</td>
      <td>0.908241</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>6</td>
      <td>28</td>
      <td>23.636164</td>
      <td>0.430497</td>
      <td>0.570100</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>6</td>
      <td>7</td>
      <td>8.804746</td>
      <td>0.336554</td>
      <td>0.849862</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>6</td>
      <td>14</td>
      <td>9.304360</td>
      <td>0.324804</td>
      <td>0.793134</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>6</td>
      <td>21</td>
      <td>9.723630</td>
      <td>0.287557</td>
      <td>0.920734</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>6</td>
      <td>28</td>
      <td>9.033072</td>
      <td>0.309908</td>
      <td>0.811674</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>6</td>
      <td>7</td>
      <td>8.800315</td>
      <td>0.335511</td>
      <td>0.850790</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>6</td>
      <td>14</td>
      <td>9.303856</td>
      <td>0.325786</td>
      <td>0.791882</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>6</td>
      <td>21</td>
      <td>9.724889</td>
      <td>0.287633</td>
      <td>0.920692</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>6</td>
      <td>28</td>
      <td>9.001938</td>
      <td>0.309867</td>
      <td>0.811724</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-7">
<h4><strong>Pronóstico de la hora 7</strong><a class="headerlink" href="#pronostico-de-la-hora-7" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora7</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">hora7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora7_min_rmse</span> <span class="o">=</span> <span class="n">hora7</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora7</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hora7_min_rmse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>7</td>
      <td>7</td>
      <td>20.195250</td>
      <td>0.436730</td>
      <td>0.551216</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>7</td>
      <td>14</td>
      <td>20.530777</td>
      <td>0.453560</td>
      <td>0.515961</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>7</td>
      <td>21</td>
      <td>12.639364</td>
      <td>0.381969</td>
      <td>0.881616</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>7</td>
      <td>28</td>
      <td>13.931040</td>
      <td>0.372805</td>
      <td>0.846283</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>7</td>
      <td>13.843998</td>
      <td>0.307299</td>
      <td>0.777806</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>14</td>
      <td>21.295631</td>
      <td>0.415977</td>
      <td>0.592855</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>21</td>
      <td>7.613160</td>
      <td>0.402198</td>
      <td>0.868745</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>28</td>
      <td>17.365585</td>
      <td>0.422824</td>
      <td>0.756157</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>7</td>
      <td>9.588294</td>
      <td>0.325104</td>
      <td>0.923284</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>14</td>
      <td>8.573194</td>
      <td>0.305199</td>
      <td>0.932390</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>21</td>
      <td>9.405520</td>
      <td>0.290390</td>
      <td>0.931577</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>28</td>
      <td>9.153729</td>
      <td>0.312764</td>
      <td>0.764512</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>7</td>
      <td>9.550950</td>
      <td>0.323094</td>
      <td>0.924230</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>14</td>
      <td>8.574775</td>
      <td>0.304564</td>
      <td>0.932671</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>21</td>
      <td>9.404443</td>
      <td>0.290591</td>
      <td>0.931483</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>28</td>
      <td>9.116991</td>
      <td>0.312624</td>
      <td>0.764724</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-8">
<h4><strong>Pronóstico de la hora 8</strong><a class="headerlink" href="#pronostico-de-la-hora-8" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora8</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">hora8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora8_min_rmse</span> <span class="o">=</span> <span class="n">hora8</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora8</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hora8_min_rmse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>8</td>
      <td>7</td>
      <td>21.644830</td>
      <td>0.449370</td>
      <td>0.536950</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>8</td>
      <td>14</td>
      <td>21.980356</td>
      <td>0.465743</td>
      <td>0.502592</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>8</td>
      <td>21</td>
      <td>13.221254</td>
      <td>0.396884</td>
      <td>0.867939</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>8</td>
      <td>28</td>
      <td>14.543433</td>
      <td>0.393510</td>
      <td>0.794901</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>8</td>
      <td>7</td>
      <td>15.184648</td>
      <td>0.323291</td>
      <td>0.760334</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>8</td>
      <td>14</td>
      <td>15.425844</td>
      <td>0.432181</td>
      <td>0.380695</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>8</td>
      <td>21</td>
      <td>8.400677</td>
      <td>0.410048</td>
      <td>0.859033</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>8</td>
      <td>28</td>
      <td>16.812397</td>
      <td>0.418663</td>
      <td>0.763398</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>8</td>
      <td>7</td>
      <td>9.913272</td>
      <td>0.329544</td>
      <td>0.918444</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>8</td>
      <td>14</td>
      <td>8.911726</td>
      <td>0.310895</td>
      <td>0.927414</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>8</td>
      <td>21</td>
      <td>8.549514</td>
      <td>0.305685</td>
      <td>0.761759</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>8</td>
      <td>28</td>
      <td>8.628066</td>
      <td>0.307355</td>
      <td>0.759148</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>8</td>
      <td>7</td>
      <td>9.923442</td>
      <td>0.327969</td>
      <td>0.919222</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>8</td>
      <td>14</td>
      <td>8.932504</td>
      <td>0.310440</td>
      <td>0.927626</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>8</td>
      <td>21</td>
      <td>8.518456</td>
      <td>0.305768</td>
      <td>0.761630</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>8</td>
      <td>28</td>
      <td>8.587234</td>
      <td>0.307237</td>
      <td>0.759334</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-9">
<h4><strong>Pronóstico de la hora 9</strong><a class="headerlink" href="#pronostico-de-la-hora-9" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora9</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">hora9</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora9_min_rmse</span> <span class="o">=</span> <span class="n">hora9</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora9</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hora9_min_rmse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>9</td>
      <td>7</td>
      <td>21.276409</td>
      <td>0.445271</td>
      <td>0.554856</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>9</td>
      <td>14</td>
      <td>21.611935</td>
      <td>0.461790</td>
      <td>0.521216</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>9</td>
      <td>21</td>
      <td>13.279225</td>
      <td>0.405668</td>
      <td>0.857086</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>9</td>
      <td>28</td>
      <td>14.403880</td>
      <td>0.390790</td>
      <td>0.778471</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>9</td>
      <td>7</td>
      <td>14.958624</td>
      <td>0.321976</td>
      <td>0.767246</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>9</td>
      <td>14</td>
      <td>15.273920</td>
      <td>0.436847</td>
      <td>0.567308</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>9</td>
      <td>21</td>
      <td>8.185879</td>
      <td>0.409547</td>
      <td>0.854340</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>9</td>
      <td>28</td>
      <td>16.875555</td>
      <td>0.423746</td>
      <td>0.756062</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>9</td>
      <td>7</td>
      <td>9.439085</td>
      <td>0.320507</td>
      <td>0.922856</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>9</td>
      <td>14</td>
      <td>8.292432</td>
      <td>0.304664</td>
      <td>0.930294</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>9</td>
      <td>21</td>
      <td>7.861649</td>
      <td>0.297512</td>
      <td>0.727826</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>9</td>
      <td>28</td>
      <td>7.860082</td>
      <td>0.297620</td>
      <td>0.727629</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>9</td>
      <td>7</td>
      <td>9.456477</td>
      <td>0.318985</td>
      <td>0.923587</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>9</td>
      <td>14</td>
      <td>8.317825</td>
      <td>0.304156</td>
      <td>0.930526</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>9</td>
      <td>21</td>
      <td>7.848215</td>
      <td>0.297924</td>
      <td>0.727072</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>9</td>
      <td>28</td>
      <td>7.836569</td>
      <td>0.297828</td>
      <td>0.727248</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-10">
<h4><strong>Pronóstico de la hora 10</strong><a class="headerlink" href="#pronostico-de-la-hora-10" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora10</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">hora10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora10_min_rmse</span> <span class="o">=</span> <span class="n">hora10</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora10</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hora10_min_rmse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>10</td>
      <td>7</td>
      <td>22.580330</td>
      <td>0.458421</td>
      <td>0.534562</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>10</td>
      <td>14</td>
      <td>22.915857</td>
      <td>0.474482</td>
      <td>0.501377</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>10</td>
      <td>21</td>
      <td>14.027643</td>
      <td>0.436616</td>
      <td>0.834112</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>10</td>
      <td>28</td>
      <td>14.591160</td>
      <td>0.404866</td>
      <td>0.774033</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>10</td>
      <td>7</td>
      <td>15.325772</td>
      <td>0.323349</td>
      <td>0.768434</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>10</td>
      <td>14</td>
      <td>15.584906</td>
      <td>0.425532</td>
      <td>0.458121</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>10</td>
      <td>21</td>
      <td>18.929521</td>
      <td>0.448806</td>
      <td>0.231845</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>10</td>
      <td>28</td>
      <td>16.912574</td>
      <td>0.424228</td>
      <td>0.760285</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>10</td>
      <td>7</td>
      <td>9.268959</td>
      <td>0.319531</td>
      <td>0.925632</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>10</td>
      <td>14</td>
      <td>9.224217</td>
      <td>0.307089</td>
      <td>0.931310</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>10</td>
      <td>21</td>
      <td>8.569853</td>
      <td>0.327686</td>
      <td>0.627568</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>10</td>
      <td>28</td>
      <td>8.543874</td>
      <td>0.327726</td>
      <td>0.627476</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>10</td>
      <td>7</td>
      <td>9.334299</td>
      <td>0.318192</td>
      <td>0.926254</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>10</td>
      <td>14</td>
      <td>9.263621</td>
      <td>0.306600</td>
      <td>0.931529</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>10</td>
      <td>21</td>
      <td>8.556077</td>
      <td>0.327741</td>
      <td>0.627443</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>10</td>
      <td>28</td>
      <td>8.520033</td>
      <td>0.327603</td>
      <td>0.627756</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-11">
<h4><strong>Pronóstico de la hora 11</strong><a class="headerlink" href="#pronostico-de-la-hora-11" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora11</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">hora11</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora11_min_rmse</span> <span class="o">=</span> <span class="n">hora11</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora11</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pronostico-de-la-hora-12">
<h4><strong>Pronóstico de la hora 12</strong><a class="headerlink" href="#pronostico-de-la-hora-12" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora12</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">hora12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora12_min_rmse</span> <span class="o">=</span> <span class="n">hora12</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora12</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora12_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>12</td>
      <td>7</td>
      <td>22.931658</td>
      <td>0.471664</td>
      <td>0.818106</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>12</td>
      <td>14</td>
      <td>14.250504</td>
      <td>0.495665</td>
      <td>0.611983</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>12</td>
      <td>21</td>
      <td>14.333990</td>
      <td>0.485833</td>
      <td>0.827711</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>12</td>
      <td>28</td>
      <td>15.232860</td>
      <td>0.428874</td>
      <td>0.775648</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>12</td>
      <td>7</td>
      <td>15.177607</td>
      <td>0.323928</td>
      <td>0.760466</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>12</td>
      <td>14</td>
      <td>10.984037</td>
      <td>0.411266</td>
      <td>0.781241</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>12</td>
      <td>21</td>
      <td>24.309155</td>
      <td>0.452298</td>
      <td>0.532996</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>12</td>
      <td>28</td>
      <td>16.604959</td>
      <td>0.410531</td>
      <td>0.754634</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>12</td>
      <td>7</td>
      <td>9.382491</td>
      <td>0.324169</td>
      <td>0.912348</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>12</td>
      <td>14</td>
      <td>10.689670</td>
      <td>0.330093</td>
      <td>0.912710</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>12</td>
      <td>21</td>
      <td>10.990716</td>
      <td>0.330334</td>
      <td>0.836930</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>12</td>
      <td>28</td>
      <td>10.400529</td>
      <td>0.348362</td>
      <td>0.735132</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>12</td>
      <td>7</td>
      <td>9.375348</td>
      <td>0.322960</td>
      <td>0.913000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>12</td>
      <td>14</td>
      <td>10.701350</td>
      <td>0.329380</td>
      <td>0.913087</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>12</td>
      <td>21</td>
      <td>11.041115</td>
      <td>0.331590</td>
      <td>0.835688</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>12</td>
      <td>28</td>
      <td>10.359014</td>
      <td>0.347856</td>
      <td>0.735902</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-13">
<h4><strong>Pronóstico de la hora 13</strong><a class="headerlink" href="#pronostico-de-la-hora-13" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora13</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">hora13</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora13_min_rmse</span> <span class="o">=</span> <span class="n">hora13</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora13</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora13_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>13</td>
      <td>7</td>
      <td>22.961744</td>
      <td>0.471363</td>
      <td>0.807977</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>13</td>
      <td>14</td>
      <td>33.690860</td>
      <td>0.500350</td>
      <td>0.456561</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>13</td>
      <td>21</td>
      <td>34.807213</td>
      <td>0.449963</td>
      <td>0.740929</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>13</td>
      <td>28</td>
      <td>15.464420</td>
      <td>0.436730</td>
      <td>0.774262</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>13</td>
      <td>7</td>
      <td>17.125563</td>
      <td>0.339163</td>
      <td>0.756081</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>13</td>
      <td>14</td>
      <td>15.329025</td>
      <td>0.445802</td>
      <td>0.843562</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>13</td>
      <td>21</td>
      <td>32.132686</td>
      <td>0.450928</td>
      <td>0.558615</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>13</td>
      <td>28</td>
      <td>28.571181</td>
      <td>0.440404</td>
      <td>0.617075</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>13</td>
      <td>7</td>
      <td>9.681186</td>
      <td>0.331589</td>
      <td>0.897773</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>13</td>
      <td>14</td>
      <td>11.367153</td>
      <td>0.335554</td>
      <td>0.874767</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>13</td>
      <td>21</td>
      <td>10.839294</td>
      <td>0.328147</td>
      <td>0.880235</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>13</td>
      <td>28</td>
      <td>11.377768</td>
      <td>0.354212</td>
      <td>0.778691</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>13</td>
      <td>7</td>
      <td>9.678483</td>
      <td>0.330654</td>
      <td>0.898348</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>13</td>
      <td>14</td>
      <td>11.399741</td>
      <td>0.335340</td>
      <td>0.911482</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>13</td>
      <td>21</td>
      <td>10.876954</td>
      <td>0.329189</td>
      <td>0.879473</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>13</td>
      <td>28</td>
      <td>11.347063</td>
      <td>0.353809</td>
      <td>0.779195</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-14">
<h4><strong>Pronóstico de la hora 14</strong><a class="headerlink" href="#pronostico-de-la-hora-14" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora14</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">hora14</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora14_min_rmse</span> <span class="o">=</span> <span class="n">hora14</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora14</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora14_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>14</td>
      <td>7</td>
      <td>24.250259</td>
      <td>0.488040</td>
      <td>0.775284</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>14</td>
      <td>14</td>
      <td>33.273127</td>
      <td>0.498748</td>
      <td>0.474298</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>14</td>
      <td>21</td>
      <td>30.667001</td>
      <td>0.422749</td>
      <td>0.759011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>14</td>
      <td>28</td>
      <td>16.038779</td>
      <td>0.453505</td>
      <td>0.766656</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>7</td>
      <td>17.787283</td>
      <td>0.341383</td>
      <td>0.769785</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>14</td>
      <td>11.603499</td>
      <td>0.452397</td>
      <td>0.709240</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>21</td>
      <td>20.048753</td>
      <td>0.439120</td>
      <td>0.198819</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>28</td>
      <td>30.537625</td>
      <td>0.454461</td>
      <td>0.609237</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>7</td>
      <td>9.716426</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>14</td>
      <td>10.729919</td>
      <td>0.325164</td>
      <td>0.918944</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>21</td>
      <td>11.026138</td>
      <td>0.332625</td>
      <td>0.884374</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>28</td>
      <td>11.525345</td>
      <td>0.352318</td>
      <td>0.904841</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>7</td>
      <td>9.658506</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>14</td>
      <td>10.734710</td>
      <td>0.324366</td>
      <td>0.919341</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>21</td>
      <td>11.046729</td>
      <td>0.332931</td>
      <td>0.884161</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>28</td>
      <td>11.514650</td>
      <td>0.351784</td>
      <td>0.905129</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-15">
<h4><strong>Pronóstico de la hora 15</strong><a class="headerlink" href="#pronostico-de-la-hora-15" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora15</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">hora15</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora15_min_rmse</span> <span class="o">=</span> <span class="n">hora15</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora15</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora15_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>15</td>
      <td>7</td>
      <td>23.893116</td>
      <td>0.486655</td>
      <td>0.783353</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>15</td>
      <td>14</td>
      <td>28.464377</td>
      <td>0.527194</td>
      <td>0.569918</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>15</td>
      <td>21</td>
      <td>30.681882</td>
      <td>0.422847</td>
      <td>0.760664</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>15</td>
      <td>28</td>
      <td>15.862533</td>
      <td>0.451959</td>
      <td>0.768313</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>15</td>
      <td>7</td>
      <td>18.259020</td>
      <td>0.399856</td>
      <td>0.752589</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>15</td>
      <td>14</td>
      <td>11.308627</td>
      <td>0.418011</td>
      <td>0.717595</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>15</td>
      <td>21</td>
      <td>29.969346</td>
      <td>0.420054</td>
      <td>0.688845</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>15</td>
      <td>28</td>
      <td>15.861101</td>
      <td>0.424505</td>
      <td>0.755286</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>15</td>
      <td>7</td>
      <td>9.734261</td>
      <td>0.320850</td>
      <td>0.913853</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>15</td>
      <td>14</td>
      <td>11.400478</td>
      <td>0.298717</td>
      <td>0.820333</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>15</td>
      <td>21</td>
      <td>11.709318</td>
      <td>0.303815</td>
      <td>0.814148</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>15</td>
      <td>28</td>
      <td>11.616939</td>
      <td>0.351351</td>
      <td>0.909002</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>15</td>
      <td>7</td>
      <td>9.676899</td>
      <td>0.320858</td>
      <td>0.913848</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>15</td>
      <td>14</td>
      <td>11.414315</td>
      <td>0.299583</td>
      <td>0.819288</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>15</td>
      <td>21</td>
      <td>11.725207</td>
      <td>0.304435</td>
      <td>0.813388</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>15</td>
      <td>28</td>
      <td>11.608909</td>
      <td>0.350840</td>
      <td>0.909266</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-16">
<h4><strong>Pronóstico de la hora 16</strong><a class="headerlink" href="#pronostico-de-la-hora-16" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora16</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">hora16</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora16_min_rmse</span> <span class="o">=</span> <span class="n">hora16</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora16</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora16_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>16</td>
      <td>7</td>
      <td>21.556284</td>
      <td>0.482269</td>
      <td>0.696128</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>16</td>
      <td>14</td>
      <td>17.613207</td>
      <td>0.482200</td>
      <td>0.487958</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>16</td>
      <td>21</td>
      <td>30.968657</td>
      <td>0.424087</td>
      <td>0.756954</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>16</td>
      <td>28</td>
      <td>16.319961</td>
      <td>0.480122</td>
      <td>0.734253</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>16</td>
      <td>7</td>
      <td>12.792681</td>
      <td>0.426477</td>
      <td>0.319667</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>16</td>
      <td>14</td>
      <td>21.598331</td>
      <td>0.391981</td>
      <td>0.668929</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>16</td>
      <td>21</td>
      <td>22.982435</td>
      <td>0.410214</td>
      <td>0.637413</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>16</td>
      <td>28</td>
      <td>20.433908</td>
      <td>0.375944</td>
      <td>0.695464</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>16</td>
      <td>7</td>
      <td>9.767949</td>
      <td>0.321807</td>
      <td>0.912484</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>16</td>
      <td>14</td>
      <td>11.078443</td>
      <td>0.294690</td>
      <td>0.825242</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>16</td>
      <td>21</td>
      <td>11.501212</td>
      <td>0.301307</td>
      <td>0.817306</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>16</td>
      <td>28</td>
      <td>12.432456</td>
      <td>0.354202</td>
      <td>0.913671</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>16</td>
      <td>7</td>
      <td>9.714451</td>
      <td>0.321861</td>
      <td>0.912454</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>16</td>
      <td>14</td>
      <td>11.096922</td>
      <td>0.295617</td>
      <td>0.824140</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>16</td>
      <td>21</td>
      <td>10.063766</td>
      <td>0.301539</td>
      <td>0.912849</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>16</td>
      <td>28</td>
      <td>12.426263</td>
      <td>0.353709</td>
      <td>0.913911</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-17">
<h4><strong>Pronóstico de la hora 17</strong><a class="headerlink" href="#pronostico-de-la-hora-17" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora17</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
<span class="n">hora17</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora17_min_rmse</span> <span class="o">=</span> <span class="n">hora17</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora17</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora17_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>17</td>
      <td>7</td>
      <td>21.556284</td>
      <td>0.483356</td>
      <td>0.694756</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>17</td>
      <td>14</td>
      <td>17.780728</td>
      <td>0.482200</td>
      <td>0.325496</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>17</td>
      <td>21</td>
      <td>26.936514</td>
      <td>0.442418</td>
      <td>0.658935</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>17</td>
      <td>28</td>
      <td>27.490370</td>
      <td>0.465976</td>
      <td>0.621646</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>17</td>
      <td>7</td>
      <td>18.686540</td>
      <td>0.439007</td>
      <td>0.638637</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>17</td>
      <td>14</td>
      <td>20.109894</td>
      <td>0.381775</td>
      <td>0.667473</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>17</td>
      <td>21</td>
      <td>21.396307</td>
      <td>0.398646</td>
      <td>0.637433</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>17</td>
      <td>28</td>
      <td>19.000035</td>
      <td>0.366928</td>
      <td>0.692834</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>17</td>
      <td>7</td>
      <td>9.821034</td>
      <td>0.322261</td>
      <td>0.911551</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>17</td>
      <td>14</td>
      <td>11.425107</td>
      <td>0.300634</td>
      <td>0.811023</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>17</td>
      <td>21</td>
      <td>9.746803</td>
      <td>0.294125</td>
      <td>0.922208</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>17</td>
      <td>28</td>
      <td>14.333517</td>
      <td>0.363456</td>
      <td>0.915048</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>17</td>
      <td>7</td>
      <td>9.768722</td>
      <td>0.322321</td>
      <td>0.911518</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>17</td>
      <td>14</td>
      <td>11.442084</td>
      <td>0.301570</td>
      <td>0.809845</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>17</td>
      <td>21</td>
      <td>9.742538</td>
      <td>0.291576</td>
      <td>0.923551</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>17</td>
      <td>28</td>
      <td>14.333260</td>
      <td>0.363045</td>
      <td>0.915240</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-18">
<h4><strong>Pronóstico de la hora 18</strong><a class="headerlink" href="#pronostico-de-la-hora-18" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora18</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">hora18</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora18_min_rmse</span> <span class="o">=</span> <span class="n">hora18</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora18</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora18_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>18</td>
      <td>7</td>
      <td>12.263832</td>
      <td>0.505849</td>
      <td>0.558980</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>18</td>
      <td>14</td>
      <td>31.850106</td>
      <td>0.472229</td>
      <td>0.618248</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>18</td>
      <td>21</td>
      <td>25.879966</td>
      <td>0.417712</td>
      <td>0.701304</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>18</td>
      <td>28</td>
      <td>16.827036</td>
      <td>0.449592</td>
      <td>0.797582</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>18</td>
      <td>7</td>
      <td>14.150000</td>
      <td>0.443148</td>
      <td>0.379818</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>18</td>
      <td>14</td>
      <td>20.632178</td>
      <td>0.385675</td>
      <td>0.660966</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>18</td>
      <td>21</td>
      <td>29.040652</td>
      <td>0.399496</td>
      <td>0.726787</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>18</td>
      <td>28</td>
      <td>19.533081</td>
      <td>0.372554</td>
      <td>0.683642</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>18</td>
      <td>7</td>
      <td>9.155890</td>
      <td>0.318370</td>
      <td>0.910779</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>18</td>
      <td>14</td>
      <td>11.769794</td>
      <td>0.310477</td>
      <td>0.798818</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>18</td>
      <td>21</td>
      <td>12.203842</td>
      <td>0.318390</td>
      <td>0.788433</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>18</td>
      <td>28</td>
      <td>14.455682</td>
      <td>0.363497</td>
      <td>0.917611</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>18</td>
      <td>7</td>
      <td>9.106688</td>
      <td>0.318461</td>
      <td>0.910727</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>18</td>
      <td>14</td>
      <td>11.772620</td>
      <td>0.310934</td>
      <td>0.798226</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>18</td>
      <td>21</td>
      <td>12.212204</td>
      <td>0.318750</td>
      <td>0.787955</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>18</td>
      <td>28</td>
      <td>14.455156</td>
      <td>0.363084</td>
      <td>0.917798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-19">
<h4><strong>Pronóstico de la hora 19</strong><a class="headerlink" href="#pronostico-de-la-hora-19" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora19</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="n">hora19</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora19_min_rmse</span> <span class="o">=</span> <span class="n">hora19</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora19</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora19_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>19</td>
      <td>7</td>
      <td>11.985471</td>
      <td>0.502278</td>
      <td>0.573004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>19</td>
      <td>14</td>
      <td>32.619337</td>
      <td>0.492138</td>
      <td>0.585380</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>19</td>
      <td>21</td>
      <td>26.585095</td>
      <td>0.438064</td>
      <td>0.671488</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>19</td>
      <td>28</td>
      <td>26.949314</td>
      <td>0.462133</td>
      <td>0.634397</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>19</td>
      <td>7</td>
      <td>13.806126</td>
      <td>0.426039</td>
      <td>0.347219</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>19</td>
      <td>14</td>
      <td>13.900010</td>
      <td>0.418930</td>
      <td>0.368822</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>19</td>
      <td>21</td>
      <td>29.704581</td>
      <td>0.413583</td>
      <td>0.707180</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>19</td>
      <td>28</td>
      <td>20.070258</td>
      <td>0.412628</td>
      <td>0.653399</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>19</td>
      <td>7</td>
      <td>9.244699</td>
      <td>0.319080</td>
      <td>0.907675</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>19</td>
      <td>14</td>
      <td>12.479213</td>
      <td>0.316882</td>
      <td>0.803850</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>19</td>
      <td>21</td>
      <td>12.823667</td>
      <td>0.322744</td>
      <td>0.796526</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>19</td>
      <td>28</td>
      <td>20.450246</td>
      <td>0.364837</td>
      <td>0.878763</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>19</td>
      <td>7</td>
      <td>9.199970</td>
      <td>0.319161</td>
      <td>0.907628</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>19</td>
      <td>14</td>
      <td>12.471681</td>
      <td>0.317096</td>
      <td>0.803585</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>19</td>
      <td>21</td>
      <td>12.827999</td>
      <td>0.323000</td>
      <td>0.796203</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>19</td>
      <td>28</td>
      <td>20.415667</td>
      <td>0.364236</td>
      <td>0.879162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-20">
<h4><strong>Pronóstico de la hora 20</strong><a class="headerlink" href="#pronostico-de-la-hora-20" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora20</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">hora20</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora20_min_rmse</span> <span class="o">=</span> <span class="n">hora20</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora20</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora20_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>20</td>
      <td>7</td>
      <td>78.730551</td>
      <td>0.478278</td>
      <td>0.704514</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>20</td>
      <td>14</td>
      <td>33.275902</td>
      <td>0.493896</td>
      <td>0.594840</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>20</td>
      <td>21</td>
      <td>27.670953</td>
      <td>0.443715</td>
      <td>0.672987</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>20</td>
      <td>28</td>
      <td>27.858404</td>
      <td>0.467582</td>
      <td>0.636862</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>20</td>
      <td>7</td>
      <td>29.202370</td>
      <td>0.420930</td>
      <td>0.873416</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>20</td>
      <td>14</td>
      <td>14.577646</td>
      <td>0.426938</td>
      <td>0.361331</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>20</td>
      <td>21</td>
      <td>16.710045</td>
      <td>0.412000</td>
      <td>0.269045</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>20</td>
      <td>28</td>
      <td>17.818840</td>
      <td>0.428843</td>
      <td>0.208060</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>20</td>
      <td>7</td>
      <td>9.550341</td>
      <td>0.320914</td>
      <td>0.903901</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>20</td>
      <td>14</td>
      <td>13.127729</td>
      <td>0.318740</td>
      <td>0.835023</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>20</td>
      <td>21</td>
      <td>13.461162</td>
      <td>0.324463</td>
      <td>0.829046</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>20</td>
      <td>28</td>
      <td>18.145749</td>
      <td>0.348050</td>
      <td>0.889621</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>20</td>
      <td>7</td>
      <td>9.530931</td>
      <td>0.321096</td>
      <td>0.903792</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>20</td>
      <td>14</td>
      <td>13.099762</td>
      <td>0.318826</td>
      <td>0.834935</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>20</td>
      <td>21</td>
      <td>13.457376</td>
      <td>0.324661</td>
      <td>0.828837</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>20</td>
      <td>28</td>
      <td>18.113337</td>
      <td>0.347461</td>
      <td>0.889994</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-21">
<h4><strong>Pronóstico de la hora 21</strong><a class="headerlink" href="#pronostico-de-la-hora-21" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora21</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">hora21</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora21_min_rmse</span> <span class="o">=</span> <span class="n">hora21</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora21</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora21_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>21</td>
      <td>7</td>
      <td>11.386265</td>
      <td>0.482459</td>
      <td>0.596346</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>21</td>
      <td>14</td>
      <td>32.937667</td>
      <td>0.482424</td>
      <td>0.630093</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>21</td>
      <td>21</td>
      <td>26.680757</td>
      <td>0.430116</td>
      <td>0.705960</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>21</td>
      <td>28</td>
      <td>27.456444</td>
      <td>0.463843</td>
      <td>0.658040</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>7</td>
      <td>18.907391</td>
      <td>0.404422</td>
      <td>0.603431</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>14</td>
      <td>31.979701</td>
      <td>0.404536</td>
      <td>0.881733</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>21</td>
      <td>14.453964</td>
      <td>0.388631</td>
      <td>0.186044</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>28</td>
      <td>15.112589</td>
      <td>0.391008</td>
      <td>0.176058</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>7</td>
      <td>20.061108</td>
      <td>0.320673</td>
      <td>0.934216</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>14</td>
      <td>12.505027</td>
      <td>0.297012</td>
      <td>0.855119</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>21</td>
      <td>12.826851</td>
      <td>0.299112</td>
      <td>0.853063</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>28</td>
      <td>18.441202</td>
      <td>0.350195</td>
      <td>0.887816</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>7</td>
      <td>19.295115</td>
      <td>0.316175</td>
      <td>0.936049</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>14</td>
      <td>12.476981</td>
      <td>0.296510</td>
      <td>0.855609</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>21</td>
      <td>12.821964</td>
      <td>0.299030</td>
      <td>0.853144</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>28</td>
      <td>18.401414</td>
      <td>0.349583</td>
      <td>0.888208</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-22">
<h4><strong>Pronóstico de la hora 22</strong><a class="headerlink" href="#pronostico-de-la-hora-22" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora22</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
<span class="n">hora22</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora22_min_rmse</span> <span class="o">=</span> <span class="n">hora22</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora22</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora22_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>22</td>
      <td>7</td>
      <td>18.410448</td>
      <td>0.491410</td>
      <td>0.592242</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>22</td>
      <td>14</td>
      <td>33.047621</td>
      <td>0.500733</td>
      <td>0.619611</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>22</td>
      <td>21</td>
      <td>27.311544</td>
      <td>0.456435</td>
      <td>0.683936</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>22</td>
      <td>28</td>
      <td>27.747725</td>
      <td>0.475605</td>
      <td>0.656830</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>22</td>
      <td>7</td>
      <td>28.156628</td>
      <td>0.411089</td>
      <td>0.877318</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>22</td>
      <td>14</td>
      <td>19.196821</td>
      <td>0.407402</td>
      <td>0.719740</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>22</td>
      <td>21</td>
      <td>20.219205</td>
      <td>0.417194</td>
      <td>0.706105</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>22</td>
      <td>28</td>
      <td>15.071364</td>
      <td>0.432371</td>
      <td>0.322895</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>22</td>
      <td>7</td>
      <td>18.004313</td>
      <td>0.309120</td>
      <td>0.941401</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>22</td>
      <td>14</td>
      <td>12.497507</td>
      <td>0.296824</td>
      <td>0.851230</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>22</td>
      <td>21</td>
      <td>12.673602</td>
      <td>0.297410</td>
      <td>0.850643</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>22</td>
      <td>28</td>
      <td>17.640166</td>
      <td>0.354919</td>
      <td>0.885505</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>22</td>
      <td>7</td>
      <td>18.696639</td>
      <td>0.305539</td>
      <td>0.942751</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>22</td>
      <td>14</td>
      <td>12.473231</td>
      <td>0.296275</td>
      <td>0.851781</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>22</td>
      <td>21</td>
      <td>12.669371</td>
      <td>0.297254</td>
      <td>0.850800</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>22</td>
      <td>28</td>
      <td>17.608553</td>
      <td>0.354436</td>
      <td>0.885817</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-23">
<h4><strong>Pronóstico de la hora 23</strong><a class="headerlink" href="#pronostico-de-la-hora-23" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora23</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
<span class="n">hora23</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora23_min_rmse</span> <span class="o">=</span> <span class="n">hora23</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora23</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora23_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>23</td>
      <td>7</td>
      <td>19.703851</td>
      <td>0.449815</td>
      <td>0.685687</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>23</td>
      <td>14</td>
      <td>26.359522</td>
      <td>0.524627</td>
      <td>0.740940</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>23</td>
      <td>21</td>
      <td>15.496085</td>
      <td>0.469982</td>
      <td>0.587013</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>23</td>
      <td>28</td>
      <td>23.946251</td>
      <td>0.476760</td>
      <td>0.786057</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>23</td>
      <td>7</td>
      <td>25.203271</td>
      <td>0.379640</td>
      <td>0.891418</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>23</td>
      <td>14</td>
      <td>31.139665</td>
      <td>0.402607</td>
      <td>0.877882</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>23</td>
      <td>21</td>
      <td>23.146897</td>
      <td>0.426096</td>
      <td>0.717961</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>23</td>
      <td>28</td>
      <td>15.416113</td>
      <td>0.466937</td>
      <td>0.387238</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>23</td>
      <td>7</td>
      <td>18.344887</td>
      <td>0.309440</td>
      <td>0.942142</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>23</td>
      <td>14</td>
      <td>13.323152</td>
      <td>0.287042</td>
      <td>0.872007</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>23</td>
      <td>21</td>
      <td>13.383824</td>
      <td>0.284638</td>
      <td>0.874142</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>23</td>
      <td>28</td>
      <td>21.343321</td>
      <td>0.384005</td>
      <td>0.867319</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>23</td>
      <td>7</td>
      <td>18.882184</td>
      <td>0.304991</td>
      <td>0.943794</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>23</td>
      <td>14</td>
      <td>13.292462</td>
      <td>0.286196</td>
      <td>0.872761</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>23</td>
      <td>21</td>
      <td>13.377857</td>
      <td>0.284339</td>
      <td>0.874406</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>23</td>
      <td>28</td>
      <td>21.297217</td>
      <td>0.383384</td>
      <td>0.867748</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pronostico-de-la-hora-24">
<h4><strong>Pronóstico de la hora 24</strong><a class="headerlink" href="#pronostico-de-la-hora-24" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">hora24</span> <span class="o">=</span> <span class="n">pliegues_modelo_hora</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">modelos</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">hora24</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">hora24_min_rmse</span> <span class="o">=</span> <span class="n">hora24</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hora24</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventana de predicción&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hora24_min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>7</td>
      <td>18.714268</td>
      <td>0.416353</td>
      <td>0.732615</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>14</td>
      <td>11.359280</td>
      <td>0.511729</td>
      <td>0.296969</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>21</td>
      <td>15.327003</td>
      <td>0.474851</td>
      <td>0.545610</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>28</td>
      <td>15.603964</td>
      <td>0.499983</td>
      <td>0.662367</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>7</td>
      <td>25.351964</td>
      <td>0.383067</td>
      <td>0.887556</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>14</td>
      <td>21.492907</td>
      <td>0.401400</td>
      <td>0.751476</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>21</td>
      <td>16.880950</td>
      <td>0.390927</td>
      <td>0.561272</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>28</td>
      <td>9.785544</td>
      <td>0.459986</td>
      <td>0.431954</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>7</td>
      <td>16.379190</td>
      <td>0.300665</td>
      <td>0.945053</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>14</td>
      <td>13.842865</td>
      <td>0.290762</td>
      <td>0.869597</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>21</td>
      <td>13.942224</td>
      <td>0.289078</td>
      <td>0.871102</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>28</td>
      <td>21.671304</td>
      <td>0.395978</td>
      <td>0.898071</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>7</td>
      <td>17.316643</td>
      <td>0.298933</td>
      <td>0.945684</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>14</td>
      <td>13.814176</td>
      <td>0.289958</td>
      <td>0.870316</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>21</td>
      <td>13.935318</td>
      <td>0.288754</td>
      <td>0.871391</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>28</td>
      <td>21.671803</td>
      <td>0.395649</td>
      <td>0.898240</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="interpretacion-general">
<h4><strong>Interpretación general</strong><a class="headerlink" href="#interpretacion-general" title="Link to this heading">#</a></h4>
<p>A lo largo de las 24 horas analizadas, se observan tendencias claras en los cuatro modelos de predicción: <strong>Regresión K-NN</strong>, <strong>Regresión Lasso</strong>, <strong>Regresión Lineal</strong>, y <strong>Regresión Ridge</strong>.</p>
<ul class="simple">
<li><p><strong>Regresión K-NN</strong> muestra consistentemente un mal rendimiento en todas las horas, con altos valores de <strong>MAPE</strong> y <strong>RMSE</strong>, y en varios casos, valores negativos de <strong>R^2</strong>. Esto sugiere que este modelo no es adecuado para este tipo de predicciones, ya que sus predicciones son a menudo peores que asumir la media de los datos. Aunque en algunas horas mejora ligeramente, sus valores de <strong>R^2</strong> rara vez superan 0.3, lo que lo convierte en el peor modelo a lo largo de las 24 horas.</p></li>
<li><p><strong>Regresión Lasso</strong> es uno de los modelos más estables y efectivos. Presenta <strong>MAPE</strong> relativamente bajos y <strong>RMSE</strong> más reducidos en comparación con K-NN. Su <strong>R^2</strong> se mantiene de manera consistente entre 0.54 y 0.62, lo que indica que captura bien la variabilidad de los datos y es una opción confiable para la mayoría de las horas. Durante las últimas horas (21 a 24), <strong>Lasso</strong> continúa siendo robusto, con un buen equilibrio entre error y precisión.</p></li>
<li><p><strong>Regresión Lineal</strong> tiene un rendimiento intermedio, con un <strong>R^2</strong> que oscila entre 0.49 y 0.61, mostrando que es un modelo decente, pero no tan eficaz como <strong>Lasso</strong> o <strong>Ridge</strong> en algunas horas. Si bien en ciertas horas su <strong>R^2</strong> alcanza valores razonables, como en las primeras 20 horas, también tiene momentos de inconsistencia, como en la hora 23, donde el <strong>R^2</strong> es negativo. Esto sugiere que la regresión lineal depende mucho de la hora y la ventana de predicción, siendo menos confiable en comparación con <strong>Lasso</strong> y <strong>Ridge</strong>.</p></li>
<li><p><strong>Regresión Ridge</strong> es el modelo que ofrece el mejor equilibrio entre precisión y error. A lo largo de las 24 horas, su <strong>R^2</strong> se mantiene consistentemente alto, entre 0.53 y 0.64, acompañado de valores bajos y estables de <strong>RMSE</strong>, lo que lo convierte en una de las mejores opciones para la predicción. En las horas finales, <strong>Ridge</strong> sigue siendo eficiente, con un <strong>R^2</strong> de hasta 0.63 en la hora 24, lo que reafirma su capacidad de realizar predicciones precisas en una variedad de escenarios.</p></li>
</ul>
<p>En general, <strong>Regresión Lasso</strong> y <strong>Regresión Ridge</strong> son las opciones más confiables para este conjunto de datos, con <strong>Ridge</strong> siendo ligeramente superior en estabilidad y precisión. <strong>Regresión K-NN</strong> muestra un mal rendimiento general a lo largo de todas las horas, mientras que <strong>Regresión Lineal</strong> ofrece un rendimiento intermedio, pero es menos consistente en comparación con <strong>Lasso</strong> y <strong>Ridge</strong>.</p>
</section>
</section>
<section id="modelos-en-general">
<h3><strong>Modelos en general</strong><a class="headerlink" href="#modelos-en-general" title="Link to this heading">#</a></h3>
<p>En esta parte del código, se agrupan todos los modelos obtenidos para cada una de las 24 horas con respecto a los cuatro modelos de regresión: <strong>KNN</strong>, <strong>Linear Regression</strong>, <strong>Ridge</strong>, y <strong>Lasso</strong>.</p>
<p>El proceso comienza creando listas vacías para cada uno de los modelos: <strong><code class="docutils literal notranslate"><span class="pre">knn_dataframes</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">linear_dataframes</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">ridge_dataframes</span></code></strong>, y <strong><code class="docutils literal notranslate"><span class="pre">lasso_dataframes</span></code></strong>, donde se almacenarán los DataFrames filtrados por cada modelo y cada hora. Luego, dentro de un bucle que recorre las 24 horas (<code class="docutils literal notranslate"><span class="pre">range(1,</span> <span class="pre">25)</span></code>), se accede a las variables dinámicamente mediante <strong><code class="docutils literal notranslate"><span class="pre">locals()</span></code></strong>, obteniendo los DataFrames agregados de cada hora (<strong>hora1_mean</strong>, <strong>hora2_mean</strong>, …, <strong>hora24_mean</strong>).</p>
<p>Para cada hora, se filtran los resultados específicos de cada modelo usando el método <strong><code class="docutils literal notranslate"><span class="pre">append</span></code></strong> y se añaden a las respectivas listas de DataFrames de cada modelo. Finalmente, estos DataFrames por modelo son concatenados usando <strong><code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code></strong> en variables agrupadas: <strong><code class="docutils literal notranslate"><span class="pre">all_knn_data</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">all_linear_data</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">all_ridge_data</span></code></strong>, y <strong><code class="docutils literal notranslate"><span class="pre">all_lasso_data</span></code></strong>, lo que permite tener todos los resultados organizados por modelo a lo largo de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">linear_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ridge_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lasso_dataframes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  
    <span class="c1"># Utilizar locals() para acceder a las variables dinámicamente</span>
    <span class="n">hora</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()[</span><span class="sa">f</span><span class="s1">&#39;hora</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_min_rmse&#39;</span><span class="p">]</span>  

    <span class="c1"># Filtrar y almacenar en las listas correspondientes</span>
    <span class="n">knn_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hora</span><span class="p">[</span><span class="n">hora</span><span class="p">[</span><span class="s1">&#39;Modelo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Regresión K-NN&#39;</span><span class="p">])</span>
    <span class="n">linear_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hora</span><span class="p">[</span><span class="n">hora</span><span class="p">[</span><span class="s1">&#39;Modelo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">])</span>
    <span class="n">ridge_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hora</span><span class="p">[</span><span class="n">hora</span><span class="p">[</span><span class="s1">&#39;Modelo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">])</span>
    <span class="n">lasso_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hora</span><span class="p">[</span><span class="n">hora</span><span class="p">[</span><span class="s1">&#39;Modelo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">])</span>

<span class="c1"># Concatenar los DataFrames filtrados por modelo</span>
<span class="n">all_knn_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">knn_dataframes</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">all_linear_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">linear_dataframes</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">all_ridge_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">ridge_dataframes</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">all_lasso_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">lasso_dataframes</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En cada una de las siguientes secciones, se presenta la tabla obtenida con todos los modelos de regresión para cada una de las 24 horas. En cada caso, se muestran <strong>4 filas por hora</strong> que corresponden a las diferentes ventanas de predicción (7, 14, 21 y 28 días). Este proceso se aplica de manera similar para los modelos <strong>KNN</strong>, <strong>Ridge</strong>, <strong>Lasso</strong>, y <strong>Linear Regression</strong>, seleccionando para cada uno el modelo con el menor <strong>RMSE</strong> para su posterior uso. Debido a la <strong>dimensión de las tablas</strong>, no es posible visualizarlas completamente en una sola vista. Sin embargo, los detalles completos pueden consultarse en las tablas individuales de cada hora, previamente presentadas.</p>
<section id="modelos-de-regresion-k-nn">
<h4><strong>Modelos de regresión K-NN</strong><a class="headerlink" href="#modelos-de-regresion-k-nn" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_knn</span> <span class="o">=</span> <span class="n">all_knn_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">all_knn_data</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">all_knn_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>7</td>
      <td>14.197404</td>
      <td>0.442003</td>
      <td>0.739650</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>14</td>
      <td>14.121390</td>
      <td>0.487220</td>
      <td>0.743249</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>21</td>
      <td>22.808862</td>
      <td>0.438482</td>
      <td>0.588184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión K-NN</td>
      <td>1</td>
      <td>28</td>
      <td>9.585378</td>
      <td>0.399166</td>
      <td>0.803793</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión K-NN</td>
      <td>2</td>
      <td>7</td>
      <td>15.437170</td>
      <td>0.457566</td>
      <td>0.730520</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión K-NN</td>
      <td>23</td>
      <td>28</td>
      <td>23.946251</td>
      <td>0.476760</td>
      <td>0.786057</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>7</td>
      <td>18.714268</td>
      <td>0.416353</td>
      <td>0.732615</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>14</td>
      <td>11.359280</td>
      <td>0.511729</td>
      <td>0.296969</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>21</td>
      <td>15.327003</td>
      <td>0.474851</td>
      <td>0.545610</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión K-NN</td>
      <td>24</td>
      <td>28</td>
      <td>15.603964</td>
      <td>0.499983</td>
      <td>0.662367</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="modelos-de-regresion-lineal">
<h4><strong>Modelos de regresión lineal</strong><a class="headerlink" href="#modelos-de-regresion-lineal" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_linear</span> <span class="o">=</span> <span class="n">all_linear_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">all_linear_data</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">all_linear_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>7</td>
      <td>34.968712</td>
      <td>0.294249</td>
      <td>0.852346</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>14</td>
      <td>17.518588</td>
      <td>0.343691</td>
      <td>0.506927</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>21</td>
      <td>21.192928</td>
      <td>0.326620</td>
      <td>0.923659</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Lineal</td>
      <td>1</td>
      <td>28</td>
      <td>11.537774</td>
      <td>0.335730</td>
      <td>0.864333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lineal</td>
      <td>2</td>
      <td>7</td>
      <td>35.154450</td>
      <td>0.311646</td>
      <td>0.842928</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Lineal</td>
      <td>23</td>
      <td>28</td>
      <td>21.343321</td>
      <td>0.384005</td>
      <td>0.867319</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>7</td>
      <td>16.379190</td>
      <td>0.300665</td>
      <td>0.945053</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>14</td>
      <td>13.842865</td>
      <td>0.290762</td>
      <td>0.869597</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>21</td>
      <td>13.942224</td>
      <td>0.289078</td>
      <td>0.871102</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Lineal</td>
      <td>24</td>
      <td>28</td>
      <td>21.671304</td>
      <td>0.395978</td>
      <td>0.898071</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="modelos-de-regresion-ridge">
<h4><strong>Modelos de regresión Ridge</strong><a class="headerlink" href="#modelos-de-regresion-ridge" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_ridge</span> <span class="o">=</span> <span class="n">all_ridge_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">all_ridge_data</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">all_ridge_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>7</td>
      <td>35.469133</td>
      <td>0.296205</td>
      <td>0.850377</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>14</td>
      <td>17.659365</td>
      <td>0.345091</td>
      <td>0.502901</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>21</td>
      <td>21.192070</td>
      <td>0.326646</td>
      <td>0.923647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Ridge</td>
      <td>1</td>
      <td>28</td>
      <td>11.507826</td>
      <td>0.335695</td>
      <td>0.864361</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Ridge</td>
      <td>2</td>
      <td>7</td>
      <td>35.714950</td>
      <td>0.314434</td>
      <td>0.840105</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Ridge</td>
      <td>23</td>
      <td>28</td>
      <td>21.297217</td>
      <td>0.383384</td>
      <td>0.867748</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>7</td>
      <td>17.316643</td>
      <td>0.298933</td>
      <td>0.945684</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>14</td>
      <td>13.814176</td>
      <td>0.289958</td>
      <td>0.870316</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>21</td>
      <td>13.935318</td>
      <td>0.288754</td>
      <td>0.871391</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Ridge</td>
      <td>24</td>
      <td>28</td>
      <td>21.671803</td>
      <td>0.395649</td>
      <td>0.898240</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="modelos-de-regresion-lasso">
<h4><strong>Modelos de regresión Lasso</strong><a class="headerlink" href="#modelos-de-regresion-lasso" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_lasso</span> <span class="o">=</span> <span class="n">all_lasso_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">all_lasso_data</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">all_lasso_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>7</td>
      <td>16.526000</td>
      <td>0.368618</td>
      <td>0.432809</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>14</td>
      <td>14.921524</td>
      <td>0.423962</td>
      <td>0.481896</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>21</td>
      <td>26.271589</td>
      <td>0.395329</td>
      <td>0.888162</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Lasso</td>
      <td>1</td>
      <td>28</td>
      <td>14.907412</td>
      <td>0.418688</td>
      <td>0.494708</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>2</td>
      <td>7</td>
      <td>16.685253</td>
      <td>0.374123</td>
      <td>0.421321</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Lasso</td>
      <td>23</td>
      <td>28</td>
      <td>15.416113</td>
      <td>0.466937</td>
      <td>0.387238</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>7</td>
      <td>25.351964</td>
      <td>0.383067</td>
      <td>0.887556</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>14</td>
      <td>21.492907</td>
      <td>0.401400</td>
      <td>0.751476</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>21</td>
      <td>16.880950</td>
      <td>0.390927</td>
      <td>0.561272</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Lasso</td>
      <td>24</td>
      <td>28</td>
      <td>9.785544</td>
      <td>0.459986</td>
      <td>0.431954</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 6 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="mejores-modelos">
<h3><strong>Mejores modelos</strong><a class="headerlink" href="#mejores-modelos" title="Link to this heading">#</a></h3>
<p>En esta sección del código, se crea un DataFrame llamado <strong><code class="docutils literal notranslate"><span class="pre">mejores_modelos</span></code></strong>, que almacena los modelos con el mejor desempeño según el menor <strong>RMSE</strong> para cada uno de los 4 modelos de regresión: <strong>KNN</strong>, <strong>Linear Regression</strong>, <strong>Ridge</strong> y <strong>Lasso</strong>. Las columnas incluyen el <strong>RMSE</strong> obtenido para cada uno de estos modelos. La tabla resultante muestra el <strong>modelo</strong>, la <strong>ventana de predicción</strong>, la <strong>hora</strong> correspondiente, y las métricas de rendimiento, como <strong>MAPE</strong>, <strong>RMSE</strong> y <strong><span class="math notranslate nohighlight">\(R^2\)</span></strong>.</p>
<p>Esta tabla permite identificar de manera rápida y comparativa cuál ha sido el mejor modelo en términos de RMSE para cada uno de los tipos de regresión, facilitando la elección del mejor modelo para nuestro conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejores_modelos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">rmse_knn</span><span class="p">,</span> <span class="n">rmse_linear</span><span class="p">,</span> <span class="n">rmse_ridge</span><span class="p">,</span> <span class="n">rmse_lasso</span><span class="p">])</span>
<span class="n">mejores_modelos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Hora</th>
      <th>Ventana de predicción</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>Regresión K-NN</td>
      <td>7</td>
      <td>28</td>
      <td>13.931040</td>
      <td>0.372805</td>
      <td>0.846283</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Lineal</td>
      <td>23</td>
      <td>21</td>
      <td>13.383824</td>
      <td>0.284638</td>
      <td>0.874142</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Ridge</td>
      <td>23</td>
      <td>21</td>
      <td>13.377857</td>
      <td>0.284339</td>
      <td>0.874406</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Regresión Lasso</td>
      <td>6</td>
      <td>7</td>
      <td>12.610870</td>
      <td>0.300416</td>
      <td>0.913486</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nótese que para cada uno de los diferentes tipos de modelo (<code class="docutils literal notranslate"><span class="pre">Regresión</span> <span class="pre">K-NN,</span> <span class="pre">Regresión</span> <span class="pre">Lineal,</span> <span class="pre">Regresión</span> <span class="pre">Ridge,</span> <span class="pre">Regresión</span> <span class="pre">Lasso</span></code>) la mejor ventana de predicción corresponde a 28 días y la mejor hora para predecir esto es diferente para cada uno de los modelos. Es decir, las mejores predicciones para este conjunto de datos se encuentran cuando se pronostica la hora 6, 7 u 8 para una ventana de predicción de 28 días.</p>
<p>En esta sección entrenaremos los modelos (<code class="docutils literal notranslate"><span class="pre">KNN</span> <span class="pre">Regresión,</span> <span class="pre">Regresión</span> <span class="pre">lineal,</span> <span class="pre">Regresión</span> <span class="pre">Lasso,</span> <span class="pre">Regresión</span> <span class="pre">Ridge</span></code>) teniendo en cuenta los resultados que se obtuvieron anteriormente, que sugieren que la mejor ventana para predecir es de 28 días. Esto se hace con el objetivo de poder encontrar los residuos de cada modelo y almacenarlos en la gráfica. Adicional a ello tomar el mejor teniendo en cuenta el menor <code class="docutils literal notranslate"><span class="pre">RMSE</span></code> y no promediarlos, para asi notar un comportamiento normal en las gráficas.</p>
<section id="pruebas-de-hipotesis-para-los-residuos">
<h4><strong>Pruebas de hipótesis para los residuos</strong><a class="headerlink" href="#pruebas-de-hipotesis-para-los-residuos" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Prueba de Ljung-Box (Ljung-Box p-value)</strong></p></li>
</ol>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (los residuos son independientes en el tiempo).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos (los residuos no son independientes en el tiempo).</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Prueba de Jarque-Bera (Jarque-Bera p-value)</strong></p></li>
</ol>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos siguen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no siguen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Regresión K-NN&#39;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(),</span>
    <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">:</span> <span class="n">LinearRegression</span><span class="p">(),</span>
    <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(),</span>
    <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">:</span> <span class="n">Lasso</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">khora</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Regresión K-NN&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="s1">&#39;hora&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
    <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;hora&#39;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;hora&#39;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;hora&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Inicialización de variables</span>
<span class="n">mejores</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">menor_RMSE</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">modelo</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">khora</span><span class="p">[</span><span class="n">nombre_modelo</span><span class="p">][</span><span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">khora</span><span class="p">[</span><span class="n">nombre_modelo</span><span class="p">][</span><span class="s1">&#39;hora&#39;</span><span class="p">],</span> <span class="n">khora</span><span class="p">[</span><span class="n">nombre_modelo</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
    
    <span class="n">train_inicial</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span>  <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Ejemplo con 1000 muestras</span>
        <span class="n">train_final</span> <span class="o">=</span> <span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>  
        <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">train_inicial</span><span class="p">,</span> <span class="n">train_final</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>
        
        <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>
        <span class="n">RMSE</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">MAPE_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Cálculo MAPE</span>
        <span class="n">R2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        
        <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
        <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Actualizar si este modelo tiene menor RMSE</span>
        <span class="k">if</span> <span class="n">RMSE</span> <span class="o">&lt;</span> <span class="n">menor_RMSE</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
            <span class="n">mejores</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">menor_RMSE</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">nombre_modelo</span><span class="p">],</span> <span class="n">RMSE</span>

        <span class="c1"># Almacenar los resultados para cada modelo</span>
        <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="n">nombre_modelo</span><span class="p">,</span>
            <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">MAPE_value</span><span class="p">,</span>
            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
            <span class="s2">&quot;R^2&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
            <span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
            <span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">:</span> <span class="n">jb_p_value</span>
        <span class="p">})</span>
        
        <span class="n">train_inicial</span> <span class="o">=</span> <span class="n">train_final</span> 

<span class="n">resultados_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">mejores_modelos</span> <span class="o">=</span> <span class="n">resultados_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultados_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Modelo&#39;</span><span class="p">)[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">mejores_modelos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Regresión K-NN</td>
      <td>13.931040</td>
      <td>0.372805</td>
      <td>0.846283</td>
      <td>0.066421</td>
      <td>0.533864</td>
    </tr>
    <tr>
      <th>568</th>
      <td>Regresión Lasso</td>
      <td>12.610870</td>
      <td>0.300416</td>
      <td>0.913486</td>
      <td>0.298656</td>
      <td>0.110608</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Regresión Lineal</td>
      <td>13.383824</td>
      <td>0.284638</td>
      <td>0.874142</td>
      <td>0.368029</td>
      <td>0.306490</td>
    </tr>
    <tr>
      <th>304</th>
      <td>Regresión Ridge</td>
      <td>13.377857</td>
      <td>0.284339</td>
      <td>0.874406</td>
      <td>0.370875</td>
      <td>0.285062</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>De la anterior tabla se puede decir, lo siguiente:</p>
<ul class="simple">
<li><p><strong>Regresión K-NN</strong> tiene el peor desempeño en cuanto a <strong>MAPE (15.41)</strong>, lo que indica que sus predicciones tienden a estar más lejos del valor real en comparación con otros modelos. Sin embargo, tiene un <strong>R² de 0.758</strong>, lo que sugiere que sigue explicando una parte considerable de la variabilidad de los datos. El <strong>valor de p de Ljung-Box es muy bajo (0.018834)</strong>, lo que podría sugerir autocorrelación en los residuos.</p></li>
<li><p><strong>Regresión Lineal</strong> muestra un buen desempeño general, con un <strong>MAPE más bajo (9.03)</strong> y un <strong>RMSE moderado (0.309)</strong>. Su <strong>R² es 0.811</strong>, lo que indica una buena capacidad para explicar la varianza de los datos. Los valores de <strong>p de Ljung-Box y Jarque-Bera (0.795153 y 0.685522, respectivamente)</strong> sugieren que no hay autocorrelación en los residuos y que estos parecen seguir una distribución normal razonable.</p></li>
<li><p><strong>Regresión Ridge</strong> tiene un rendimiento similar a la regresión lineal, con un <strong>MAPE ligeramente más bajo (9.009950)</strong> y un <strong>RMSE similar (0.309872)</strong>. Su <strong>R² es prácticamente idéntico (0.811718)</strong>, indicando un desempeño casi idéntico en cuanto a ajuste. Los valores de <strong>p también sugieren que no hay problemas de autocorrelación o distribución de los residuos</strong>.</p></li>
<li><p><strong>Regresión Lasso</strong> tiene un <strong>MAPE más alto (14.01)</strong>, indicando que, aunque el <strong>RMSE es bajo (0.308020)</strong>, no es tan preciso como otros modelos para predecir valores individuales. Su <strong>R² (0.776762)</strong> es algo inferior a los modelos lineales y Ridge, pero sigue siendo razonable. Los valores de <strong>p indican que no hay problemas de autocorrelación y que los residuos son aceptablemente normales</strong>.</p></li>
</ul>
<p>En general, <strong>la regresión lineal y Ridge</strong> parecen ser las mejores opciones en términos de precisión, con buenos valores en todas las métricas. <strong>La regresión Lasso y K-NN</strong> presentan mayores errores de predicción (<strong>MAPE más altos</strong>), siendo <strong>el K-NN el modelo menos eficaz</strong> en general debido a su alto error absoluto y posibles problemas de autocorrelación.</p>
</section>
</section>
</section>
<section id="hiperparametrizacion-optimizacion-bayesiana">
<h2><strong>Hiperparametrización: Optimización Bayesiana</strong><a class="headerlink" href="#hiperparametrizacion-optimizacion-bayesiana" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periodos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">pliegues_ob</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">):</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">periodos</span><span class="p">:</span>  
        <span class="n">train_inicial</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="n">train_final</span> <span class="o">=</span> <span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>
            
            <span class="c1"># Generar los índices de entrenamiento y prueba</span>
            <span class="n">train_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">train_inicial</span><span class="p">,</span> <span class="n">train_final</span><span class="p">)</span>  <span class="c1"># Rango de índices de entrenamiento</span>
            <span class="n">test_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">train_final</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">train_final</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>  <span class="c1"># Rango de índices de prueba</span>
            
            <span class="c1"># Asegurarse de que los índices son válidos y no están fuera de rango</span>
            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">test_indices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
                <span class="n">cv</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span><span class="p">))</span>
            
            <span class="n">train_inicial</span> <span class="o">=</span> <span class="n">train_final</span>
    
    <span class="k">return</span> <span class="n">cv</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Paso 1: Definir el espacio de búsqueda</span>

<span class="n">ridge_space</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Real</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;alpha&#39;</span><span class="p">),</span>  <span class="c1"># Alpha es el parámetro de regularización en Ridge</span>
    <span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;svd&#39;</span><span class="p">,</span> <span class="s1">&#39;cholesky&#39;</span><span class="p">,</span> <span class="s1">&#39;lsqr&#39;</span><span class="p">,</span> <span class="s1">&#39;sag&#39;</span><span class="p">,</span> <span class="s1">&#39;saga&#39;</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;solver&#39;</span><span class="p">)</span> <span class="p">]</span>

<span class="c1"># Paso 2: Definir la función objetivo</span>

<span class="k">def</span> <span class="nf">ridge_objective</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="c1"># Extraer los parámetros de la lista</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Primer parámetro es alpha</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Segundo parámetro es solver</span>
    <span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">solver</span> <span class="o">=</span> <span class="n">solver</span><span class="p">)</span> <span class="c1"># Definir el modelo de Ridge con los parámetros obtenidos</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">pliegues_ob</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span> <span class="o">=</span> <span class="mi">23</span><span class="p">)</span>  <span class="c1"># Pliegues definidos para el modelo</span>
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">cv</span><span class="p">:</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span> <span class="c1"># Calcular el MSE para cada pliegue</span>
    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span> <span class="c1"># Calcular el MSE promedio</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>  <span class="c1"># Devolver el MSE promedio como la función de pérdida que gp_minimize minimizará</span>

<span class="c1"># Paso 3: Optimización de hiperparámetros</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">ridge_objective</span><span class="p">,</span> <span class="n">ridge_space</span><span class="p">,</span> <span class="n">n_calls</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Optimización con gp_minimize</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mejores hiperparámetros: alpha = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, solver = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: alpha = 9.989305506028346, solver = saga
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-final">
<h2><strong>Modelo final</strong><a class="headerlink" href="#modelo-final" title="Link to this heading">#</a></h2>
<section id="modelo-con-los-mejores-hiperparametros">
<h3><strong>Modelo con los mejores hiperpárametros</strong><a class="headerlink" href="#modelo-con-los-mejores-hiperparametros" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">23</span>
<span class="n">final</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">train_inicial</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="p">(</span><span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">train_final</span> <span class="o">=</span> <span class="n">train_inicial</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">train_inicial</span><span class="p">,</span> <span class="n">train_final</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>
    
    <span class="n">alpha_opt</span> <span class="o">=</span> <span class="mf">9.989305506028346</span>
    <span class="n">solver_opt</span> <span class="o">=</span> <span class="s1">&#39;saga&#39;</span>
    <span class="n">ridge_model</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha_opt</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver_opt</span><span class="p">)</span>
    <span class="n">nombre_modelo</span> <span class="o">=</span> <span class="s1">&#39;Regresión Ridge&#39;</span>
    <span class="n">ridge_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>
    <span class="n">RMSE</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">MAPE_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">R2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">final</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="n">nombre_modelo</span><span class="p">,</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">MAPE_value</span><span class="p">,</span>
        <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
        <span class="s2">&quot;R^2&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
        <span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>

    <span class="n">train_inicial</span> <span class="o">=</span> <span class="n">train_final</span>

<span class="n">resultadofinal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
<span class="n">modelofinal</span> <span class="o">=</span> <span class="n">resultadofinal</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">resultadofinal</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Modelo&#39;</span><span class="p">)[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">modelofinal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Regresión Ridge</td>
      <td>13.356363</td>
      <td>0.283331</td>
      <td>0.875296</td>
      <td>0.388303</td>
      <td>0.179993</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="grafica-del-modelo-final">
<h3><strong>Gráfica del modelo final</strong><a class="headerlink" href="#grafica-del-modelo-final" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grafica</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">nombre_modelo</span><span class="p">):</span>
    <span class="n">r2_train_lasso</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
    <span class="n">r2_test_lasso</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>

    <span class="n">rmse_train_lasso</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">))</span>
    <span class="n">rmse_test_lasso</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Velocidad original&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train_pred</span><span class="p">)),</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Velocidad predicha&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocidad del viento&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_train_lasso</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse_train_lasso</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Velocidad original&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test_pred</span><span class="p">)),</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Velocidad predicha&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocidad del viento&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_test_lasso</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse_test_lasso</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  
    
    <span class="k">return</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grafica</span><span class="p">(</span><span class="n">mejores</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">mejores</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">mejores</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">mejores</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">mejores</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de2baebcf88682435086fc7a5b134f7962fe0d92c993142c4803ec00f0cb5af2.png" src="_images/de2baebcf88682435086fc7a5b134f7962fe0d92c993142c4803ec00f0cb5af2.png" />
</div>
</div>
<p>En la gráfica de la <strong>Regresión Ridge</strong> se observan los resultados para el conjunto de entrenamiento y el de prueba. En el conjunto de <strong>entrenamiento</strong>, el modelo presenta un <strong>R² de 0.78</strong> y un <strong>RMSE de 0.62</strong>, lo que indica un ajuste aceptable pero con un error algo elevado. Las predicciones siguen la tendencia de los datos originales, aunque con bastante ruido. En el conjunto de <strong>prueba</strong>, el desempeño mejora con un <strong>R² de 0.81</strong> y un <strong>RMSE de 0.31</strong>, lo que sugiere que el modelo generaliza bien, con predicciones mucho más precisas y alineadas con los valores reales. En conclusión, el modelo tiene mejor capacidad de predicción en los datos de prueba que en los de entrenamiento, lo que indica una buena generalización.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ejercicio2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Ejercicio 2: Modelos de Clasificación</strong></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Ejercicio 3: Modelos de Regresión</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-wind-speed"><strong>Modelo de regresión: Wind Speed</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos"><strong>Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diferencias-entre-la-base-de-datos-original-y-la-del-modelo"><strong>Diferencias entre la base de datos original y la del modelo</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>Modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-para-construir-los-pliegues"><strong>Función para construir los pliegues</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-individuales-por-horas-24-horas"><strong>Modelos individuales por horas (24 horas)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-1"><strong>Pronóstico de la hora 1</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-2"><strong>Pronóstico de la hora 2</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-3"><strong>Pronóstico de la hora 3</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-4"><strong>Pronóstico de la hora 4</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-5"><strong>Pronóstico de la hora 5</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-6"><strong>Pronóstico de la hora 6</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-7"><strong>Pronóstico de la hora 7</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-8"><strong>Pronóstico de la hora 8</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-9"><strong>Pronóstico de la hora 9</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-10"><strong>Pronóstico de la hora 10</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-11"><strong>Pronóstico de la hora 11</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-12"><strong>Pronóstico de la hora 12</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-13"><strong>Pronóstico de la hora 13</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-14"><strong>Pronóstico de la hora 14</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-15"><strong>Pronóstico de la hora 15</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-16"><strong>Pronóstico de la hora 16</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-17"><strong>Pronóstico de la hora 17</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-18"><strong>Pronóstico de la hora 18</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-19"><strong>Pronóstico de la hora 19</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-20"><strong>Pronóstico de la hora 20</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-21"><strong>Pronóstico de la hora 21</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-22"><strong>Pronóstico de la hora 22</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-23"><strong>Pronóstico de la hora 23</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pronostico-de-la-hora-24"><strong>Pronóstico de la hora 24</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-general"><strong>Interpretación general</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-en-general"><strong>Modelos en general</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-k-nn"><strong>Modelos de regresión K-NN</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-lineal"><strong>Modelos de regresión lineal</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-ridge"><strong>Modelos de regresión Ridge</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion-lasso"><strong>Modelos de regresión Lasso</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mejores-modelos"><strong>Mejores modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-hipotesis-para-los-residuos"><strong>Pruebas de hipótesis para los residuos</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hiperparametrizacion-optimizacion-bayesiana"><strong>Hiperparametrización: Optimización Bayesiana</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-final"><strong>Modelo final</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-con-los-mejores-hiperparametros"><strong>Modelo con los mejores hiperpárametros</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-del-modelo-final"><strong>Gráfica del modelo final</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kanery Marcela Camargo Rodríguez y Emanuel de Jesús Carbonell Naranjo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>